<!DOCTYPE html>
<html lang="en">
<head>
	<title>Login</title>
</head>
<body>
<form name="loginForm" enctype="multipart/form-data">
	<label for="email">Email:</label>
	<input type="text" name="email" id="email"/>
	<br/>
	<label for="password">Password:</label>
	<input type="password" name="password" id="password"/>
	<br/>
	<input type="submit"/>
</form>
<br/>
<a href="/register">Register</a>
<script>
    window.addEventListener('load', () => {
        const form = document.loginForm;
        form.addEventListener('submit', (event) => {
            event.preventDefault();
            const data = new FormData(form);
            fetch('/login', {method: "POST", body: data}).then(async (resp) => {
                const res = await resp.json();
                if (res.success) {
                    window.location.replace('/');
                } else {
                    alert(res.error);
                }
            });
        });
    });
</script>
</body>
</html>
