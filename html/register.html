<!DOCTYPE html>
<html>
<head>
	<title>Register</title>
</head>
<body>
<form id="regForm" enctype="multipart/form-data">
	<label for="name">Name:</label>
	<input type="text" name="name" id="name"/>
	<br/>
	<label for="email">Email:</label>
	<input type="text" name="email" id="email"/>
	<br/>
	<label for="password">Password (must be at least 8 characters long, contain a number, and a special
		character):</label>
	<input type="password" name="password" id="password"/>
	<br/>
	<label for="confirm_password">Confirm password:</label>
	<input type="password" name="confirm_password" id="confirm_password"/>
	<br/>
	<input id="submitButton" type="submit"/>
</form>
<br/>
<a href="/login">Login</a>
<script>
    window.addEventListener('load', () => {
        const form = document.getElementById('regForm');
        form.addEventListener('submit', (event) => {
            event.preventDefault();
            const submitButton = document.getElementById('submitButton');
			submitButton.disabled = true;
            const data = new FormData(form);
            fetch('/register', {method: "POST", body: data}).then(async (resp) => {
                if (resp.ok) {
                    alert('Registered. Check your email to verify your account. The verification email may be in your junk folder.')
                    window.location.replace('/');
                } else {
                    alert(await resp.text());
                    submitButton.disabled = false;
                }
            });
        });
    });
</script>
</body>
</html>
